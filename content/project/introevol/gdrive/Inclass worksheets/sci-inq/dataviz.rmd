---
title: "Representing Data with Figures"
date: BIOL01104 Fall 2019, Dr. Spielman
output: pdf_document
fontsize: 11pt
geometry: margin=0.5in
---

```{r setup, include=FALSE}
library(tidyverse)
library(dslabs)
library(patchwork)
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, fig.margin=T, fig.height=3, fig.width=4)
theme_set(theme_classic() + theme(legend.position = "none"))
```



This worksheet uses a dataset of information about olives collected from Italy. The data contains information about the fatty acid content for 572 olives from Northern Italy, Southern Italy, and Sardenia (a Mediterranean island off the coast of Italy). Answer questions about each plot with your table. **For all plots**, identify the type of data (quantitative or categorical) on each axis.

# Histograms

The histograms below show the distribution of oleic acid percentages for olives collected from the three regions.

+ Which region has the highest mean oleic acid percentage? The lowest?
+ Which region has the highest standard deviation oleic acid percentage? The lowest?
+ What is the minimum, maximum, and mode for each distribution?

```{r}
ggplot(olive, aes(x  = oleic)) + geom_histogram(aes(fill = region), color="black") + facet_grid(~region) + xlab("Oleic Acid Percentage") + ylab("Count")
```

\vspace{0.5cm}

The histograms below show the *same* distributions as above, but with different *bin widths*. How do your answers to the questions change? What does this tell you about the importance of choosing good histogram bin widths?


```{r}
ggplot(olive, aes(x  = oleic)) + geom_histogram(aes(fill = region), binwidth=7, color="black") + facet_grid(~region) + xlab("Oleic Acid Percentage") + ylab("Count") 
```



# Boxplots

The boxplots below again shown the distribution of oleic acid percentages for olives collected from the three regions. Answer the same questions (mean, standard deviation). Were boxplots or histograms more informative for answering these questions?

```{r}
ggplot(olive, aes(x = region, y = oleic)) + geom_boxplot(aes(fill=region)) + xlab("Region") + ylab("Oleic Acid Percentage")
```

\vspace{0.5cm}

The boxplots below shown the distribution of linolenic acid percentages for olives collected from the three regions. Answer the same questions (mean, standard deviation). Then, compare the trends you observed for the previous boxplots of oleic acid to these linolenic acid boxplots. What are the similarities and differences between these two types of acids in olives?

```{r}
ggplot(olive, aes(x = region, y = linolenic)) + geom_boxplot(aes(fill=region)) + xlab("Region") + ylab("Linolenic Acid Percentage")
```


**Finally**, draw by hand (with your table!) a *bar plot* showing the mean oleic acid percentage for each region. Include rough estimates of standard deviation error bars.


\newpage

# Barplots

The barplot below shows the number of olives collected from each region. 

From which region were the most olives collected? The fewest?

In addition, compare the general look of this barplot to the first histogram in this document. Although barplots and histograms look similar, they have some key differences. Take this opportunity to determine what those differences are.

```{r}
ggplot(olive, aes(x = region)) + geom_bar(aes(fill=region), color="black") + scale_y_continuous(expand=c(0,0))
```

\newpage
# Scatterplots, Part 1

The scatterplot below shows the *relationship* between percentages of oleic aand linoleic acid in each olive. Thus, there are 572 points in this figure (1 point per olive).

Is there a strong, moderate or weak correlation? Is the correlation positive or negative?

```{r}
olive  %>% ggplot(aes(x = oleic, y = linoleic)) + geom_point() + xlab("Oleic Acid Percentage") + ylab("Linoleic Acid Percentage") 
```


\vspace{1cm}
The scatterplot below is a modified version of the above scatterplot, where this time points are colored according to which region the olive comes from. 

What differences and similarities do you observe among regions? Which region appears to have the highest correlation? The lowest? Are all correlations the same direction (positive or negative)?

```{r}
olive  %>% ggplot(aes(x = oleic, y = linoleic)) + geom_point(aes(color=region)) + xlab("Oleic Acid Percentage") + ylab("Linoleic Acid Percentage") 
```


\newpage
# Scatterplots, part 2

Below are four different scatterplots each with a *line of best fit* showing the overall relationship between X and Y variables. Each plot shows the relationship between two different types of fatty acids, for Southern Italy olives only. 

Characterize each plot as having a strong, moderate or weak correlation, as well as whether the correlation is positive or negative.

```{r, fig.height=8, fig.width=3}
olive %>% filter(region == "Southern Italy") -> southolive
southolive  %>% ggplot(aes(x = oleic, y = linoleic))+ xlab("Oleic Acid Percentage") + ylab("Linoleic Acid Percentage") + geom_point() + geom_smooth(method = "lm", se=F)-> scat.strongneg
southolive %>% ggplot(aes(x = oleic, y = arachidic)) + xlab("Oleic Acid Percentage") + ylab("Arachidic Acid Percentage") + geom_point() + geom_smooth(method = "lm", se=F) -> scat.weakpos
southolive %>% ggplot(aes(x = oleic, y = eicosenoic)) +  xlab("Oleic Acid Percentage") + ylab("Eicosenoic Acid Percentage") + geom_point() + geom_smooth(method = "lm", se=F) -> scat.medpos
southolive %>% ggplot(aes(x = palmitic, y = palmitoleic)) + geom_point() +  xlab("Palmitic Acid Percentage") + ylab("Palmitoleic Acid Percentage") + geom_point() + geom_smooth(method = "lm", se=F) -> scat.strongpos
scat.strongneg / scat.weakpos / scat.strongpos / scat.medpos
```












